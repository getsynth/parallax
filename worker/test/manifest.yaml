- user:
    name: "unit-tester"
    email: "unit-tester@openquery.io"
    super_user: true
    public_keys:
    - |
      -----BEGIN PUBLIC KEY-----
      MIIBCgKCAQEAxV3TnMIkVGe0967ODyM8LdD6RcxMblMKFIhxAK4tLKepyCyq3YlZ
      S+ckNFvY0kMA29NOKe0N0Of7XpNA4RBaFARnAQS+pfcP+BxBYqKl6mvXS+P8TKO3
      J8guqebVn/d8BNAYLEzSmmHo+d4xpzyUdli9JKvgiaG+9mN/riHyu7/AY00BL/by
      17F4rdL5w08H22eSoq2uJSr4yLlhFDdWzIL9TQz7K61o85FNiiV5yEATC6/ExWAD
      3va11Y4GUCp2fmNhexrDQXsGbFW+SWmdZA55iXO31H42iYX2HqF8wz3Lsy7n0Aa8
      UgsxcBbkPp5oLYdEffgdeBtdnuu73oVcGQIDAQAB
      -----END PUBLIC KEY-----
    primary_group: resource.group.group1

- group:
    name: "group1"
    members:
    - resource.user.unit-tester

- backend:
    big_query:
      name: "a_bigquery_backend"
      service_account_key: "../../secret/unit-tester.json"
      project_id: "openquery-dev"
      dataset_id: "yelp"
      staging_project_id: "openquery-dev"
      staging_dataset_id: "cache"

- dataset:
    name: "yelp"
    data:
    - resource.backend.big_query.a_bigquery_backend.data["review"]
    - resource.backend.big_query.a_bigquery_backend.data["business"]
    entities: []
    policy_bindings:
    - name: "group1_policies"
      groups:
      - resource.group.group1
      policies:
      - policy.whitelist.business_id_is_whitelisted
      - policy.obfuscate.review_id_is_obfuscated
      - policy.hash.user_id_is_hashed
      - policy.differential_privacy.users_have_differential_privacy
      priority: 10
    policies:
    - whitelist:
        name: "business_id_is_whitelisted"
        fields:
        - "business_id"
    - obfuscate:
        name: "review_id_is_obfuscated"
        fields:
        - "review_id"
    - hash:
        name: "user_id_is_hashed"
        salt: []
        fields:
        - "user_id"
    - differential_privacy:
        name: "users_have_differential_privacy"
        entity: "user_id"
        epsilon: 1.0
        bucket_size: 15
